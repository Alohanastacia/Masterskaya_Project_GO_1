# Masterskaya_Project_GO_1

# Сервис подачи жалоб

## 1. Описание проекта
Резерв

## 2. Установка
Резерв

## 3. Использование
Для упрощения взаимодействия с приложением используется утилита make. В терминале вы должны находится в корневом каталоге проекта.<br><br>
3.1. Собрать образ через Docker-Compose:
```bash
make build
```
3.2. Запустить контейнеры:
```bash
make run-local
```
3.3. Если контейнеры на компьютере запущены впервые и не создан сервер СУБД, то нужно создать сервер СУБД. Это можно сделать через консольную утилиту psql или веб-интерфейс pgAdmin, который является одним из запущенных контейнеров.<br><br>
Для доступа к pgAdmin и созданию сервера, необходима информация о контейнерах pgAdmin и PostgreSQL, указанная в файле docker-compose и конфигурации приложения, заданных в переменных окружения.<br><br>
Далее предлагается инструкция по созданию сервера СУБД с параметрами по-умолчанию (могут быть изменены) для локального компьютера через pgAdmin:<br>
 
>3.3.1. Открыть браузер.<br>
3.3.2. Ввести в адресную строку localhost:5050 и нажать Enter.<br>
3.3.3. Появится веб-интерфейс pgAdmin. Введите мастер-пароль, например postgres.<br>
3.3.4. В веб-интерфейсе pgAdmin с левой стороны должен быть значок Servers. Щёлкните по нему правой кнопкой мыши.<br>
3.3.5. В появившемся окне выберите Register > Server...<br>
3.3.6. Появится окно создания сервера с несколькими вкладками. В первой вкладке General в поле Name введите произвольное имя сервера СУБД, например PostgreSQL_server_practicum.<br>
3.3.7. Перейдите во вкладку Connection. В поле Host name/adress введите наименование контейнера PostgreSQL из docker-compose-файла, а именно: postgres_complaint_service_1.<br>
Для поля Port: 5432<br>
Для полей Maintaince database, Username и Password: postgres<br>
3.3.8. Остальные настройки оставьте по-умолчанию и нажимите кнопку Save внизу справа.<br>
3.3.9. Сервер СУБД готов к работе.<br>
<br>

3.4. Применить миграции схемы БД<br>
В случае запуска docker-контейнеров без фонового режима (поведение по-умолчанию), потребуется запуск отдельного терминала (например, сочетанием клавишь Ctrl+Enter в VSCode) и выполнения команды в нём:
```bash
make migrate-up
```
Приложение готово к работе.

## 4. Опции приложения
4.1. Посмотреть статус миграций в БД
```bash
make migrate-status:
```
4.2. Откатить последнюю миграцию
```bash
make migrate-down
```
4.3. Создать файл миграции с заданным форматом<br>
Используется для изменения схемы БД с соблюдением стандарта префикса наименования файла миграции для очерёдности применения миграций.
```bash
make migrate-create name=table
```
где table - желаемое смысловое имя миграции, например first_admin.<br>
Далее в созданную таблицу нужно внести sql-код с аннотациями библиотеки миграций. Далее миграция готова к применению.
